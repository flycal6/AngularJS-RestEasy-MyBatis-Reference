<div class="container">

    <h2>Drivers</h2>

    <!-- New Driver Entry Form -->
    <div ng-show="!vm.selected">
        <form>
            <div class="form-group">
                <label for="fName">First Name</label>
                <input type="text" class="form-control" id="fName" placeholder="First Name" ng-model="vm.newDriver.fName" required>
                <small id="makeHelp" class="form-text text-muted">Enter the driver's first name.</small>
            </div>
            <div class="form-group">
                <label for="lName">Last Name</label>
                <input type="text" class="form-control" id="lName" placeholder="Last Name" ng-model="vm.newDriver.lName" required>
            </div>
            <div class="form-group">
                <label for="carOptions">Car</label>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <div class="input-group-text">Choose Driver's Car</div>
                    </div>
                    <select class="form-control" name="carOptions" id="carOptions" ng-model="vm.newDriver.car.id" required>
                    <option ng-repeat="car in vm.cars" value={{car.id}}>
                        {{car.make}} {{car.model}}
                    </option>
                </select>
                </div>
            </div>
            <!-- <button type="submit" class="btn btn-primary" ng-click="vm.createDriver(vm.newDriver); vm.newDriver = {}">Create</button> -->
            <button type="submit" class="btn btn-primary" ng-click="vm.createDriver(vm.newDriver)">Create</button>
        </form>
        <hr />
    </div>

    <!-- Index table of all drivers -->
    <table class="table table-striped table-hover" ng-show="!vm.selected">
        <thead>
            <tr>
                <th ng-click="vm.orderProp = 'id'">ID</th>
                <th ng-click="vm.orderProp = 'fName'">First Name</th>
                <th ng-click="vm.orderProp = 'lName'">Last Name</th>
                <th ng-click="vm.orderProp = 'car.id'">Car</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="d in vm.drivers | orderBy : vm.orderProp" ng-click="vm.show(d.id)">
                <td>{{d.id}}</td>
                <td>{{d.fName}}</td>
                <td>{{d.lName}}</td>
                <td>#{{d.car.id}} {{d.car.make}} {{d.car.model}}</td>
            </tr>
        </tbody>
    </table>

    <!-- detail view of a single driver -->
    <div ng-show="vm.selected && !vm.updating">
        <h2><span class="text-muted">ID:</span> {{vm.selected.id}}</h2>
        <h2><span class="text-muted">First Name:</span> {{vm.selected.fName}}</h2>
        <h2><span class="text-muted">Last Name:</span> {{vm.selected.lName}}</h2>
        <h2><span class="text-muted">Car:</span> #{{vm.selected.car.id}} {{vm.selected.car.make}} {{vm.selected.car.model}}</h2>
        <button class="btn btn-block btn-success" ng-click="vm.update()">Update</button>
        <button class="btn btn-block btn-danger" ng-click="vm.deleteDriver(vm.selected.id)">Delete</button>
    </div>

    <!-- update driver view -->
    <div ng-show="vm.selected && vm.updating">
        <form>
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">First Name</span>
                    </div>
                    <input class="form-control" type="text" ng-model="vm.selected.fName" />
                </div>
            </div>
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Last Name</span>
                    </div>
                    <input type="text" class="form-control" ng-model="vm.selected.lName" />
                </div>
            </div>
            <div class="form-group">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <div class="input-group-text">Choose Driver's Car</div>
                    </div>
                    <select class="form-control" ng-model="vm.selected.car.id" required>
                        <option ng-repeat="car in vm.cars" value={{car.id}}>
                            {{car.make}} {{car.model}}
                        </option>
                    </select>
                </div>
            </div>
            <button class="btn btn-primary" ng-click="vm.updateDriver(vm.selected)">Perform Update</button>
        </form>
    </div>
</div>
